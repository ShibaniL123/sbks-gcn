Technical Field The present invention relates to a particle beam irradiation apparatus used for cancer treatment, and particularly to a particle beam irradiation apparatus for performing scanning irradiation such as spot-scanning, raster-scanning or the like. Background Art A broad irradiation method is an irradiation method which has been most broadly used in a particle beam irradiation apparatus used for medical care such as a cancer treatment, etc. and for researches. The broad irradiation method is a method of spreading a charged particle beam by using a scattering member and a wobbler electromagnet and reducing irradiation to places other than a diseased site by using a collimator or a bolus. In addition to the broad irradiation method for irradiating an irradiation subject area at a stroke, a scanning irradiation method for irradiating a diseased site as an irradiation subject with a charged particle beam every small area while scanning the charged particle beam, such as spot scanning or raster scanning has been proposed (for example, Non-Patent Document 1). There have been also proposed a technique in which a conventional particle beam irradiation apparatus for performing scanning irradiation disclosed in the Non-Patent Document 1 is further modified so that a scanning electromagnet is disposed at the upstream side of a final bending electromagnet, thereby remarkably reducing the radius of a gantry (Patent Document 1) and a technique in which the scanning electromagnet can be omitted (Patent Document 2). Furthermore, means for correcting a deflection scanning position displacement in a charged particle bean scanning apparatus used to irradiate a beam onto a sample has been proposed although it is not a particle beam irradiation apparatus for medical care or for researches (Patent Document 3). It is general in the scanning irradiation method that a part for preventing irradiation to normal tissues other than a diseased site such as a collimator or a bolus used in the broad irradiation method is not provided, and thus higher beam position precision than the broad irradiation method is required. As described above, a device for compensating the beam position precision has been hardly disclosed although the scanning irradiation method requires the higher beam position precision than the broad irradiation method. Furthermore, when a charged particle beam of proton, carbon ion or the like is incident into substance such as the body or the like, it travels till the specific depth (called as a range) corresponding to the energy of the charged particle beam in the substance, a peak at which the maximum energy is applied from the charged particle beam to the substance exists in the neighborhood of the terminal of the range (called as "Bragg peak"), and the charged particle beam has a characteristic that the Bragg peak thereof has a shaper depth dose distribution as compared with other radiation rays such as X-ray, etc. The particle beam irradiation apparatus suppresses the charged particle beam from affecting normal tissues by utilizing this characteristic, whereby the dose is concentrically irradiated onto the diseased site. From this viewpoint, in a scanning particle beam irradiation apparatus or treatment plan apparatus for performing spot scanning or raster scanning, control amounts for scanning means and an accelerator have been hitherto calculated on the assumption that the in-body depth direction (Z direction) of the desired irradiation position and the X-direction and Y-direction perpendicular to the Z direction can be separately controlled by adjusting the energy of the charged particle beam and controlling the scanning means such as the scanning electromagnet or the like, respectively. Prior Art Document Patent Document Patent Document 1: JP-A-2007-534 391 Patent Document 2: JP-A-2006-166 947 Patent Document 3: Pamphlet of Internal Publication No. WO01/69643 Furthermore, WO2008/003527 discloses a method and a device for treating a target volume with a particle beam. JP2007132902 discloses a particle beam irradiation system with an improved precision in the beam irradiation position. Non-Patent Document Non-Patent Document 1: Tatsuaki Kanai, et al., "Spot scanning system for proton radiotherapy", Medical Physics, July./Aug. 1980, Vol.7, No.4, pp365-369 Summary of the Invention Problem to be solved by the Invention When the charged particle beam is a parallel beam having a fixed traveling direction, the z coordinate of the beam irradiation position can be uniquely determined by only the energy of the charged particle beam. However, in a particle beam irradiation apparatus in which the direction of the beam is controlled by scanning means such as an actual scanning electromagnet or the like, the charged particle beam becomes a fan beam (one-dimensional scanning) which spreads out in a fan-like form or a cone beam (two-dimensional scanning) which spreads out in a conical shape. Therefore, the z coordinate of the beam irradiation position cannot be uniquely determined by the energy of the charged particle beam. The effect of the fan beam on the irradiation position is called as an fan beam effect, and the effect of the cone beam on the irradiation position is called as a cone beam effect. Figs. 8A and 8B are diagrams showing the fan beam effect and the cone beam effect. In Figs. 8A and 8B, 1 represents a charged particle beam, 31 represents the body of a patient, and 32 represents the surface of the body. Fig. 8A shows the fan beam effect, and when the charged particle beam 1 is one-dimensionally scanned, the z-coordinate of the end portion 33 of the irradiation position and the z-coordinate of the center portion 34 are not fixed. Fig. 8B shows the cone beam effect, and when the charged particle beam 1 is two-dimensionally scanned, the z-coordinate of the end portion 33 of the irradiation position and the z-coordinate of the center portion 34 are not fixed. The present invention has been implemented to solve the foregoing problem, and has an object to provide a particle beam irradiation apparatus that can implement a high-precision beam irradiation position. Means of solving the Problem The particle beam irradiation apparatus according to the invention is defined in claim 1. A particle beam irradiation apparatus for irradiating an irradiation subject with a charged particle beam accelerated by an accelerator while scanning the charged particle beam by a scanning electromagnet is provided with inverse mapping means having an inverse mapping model for generating a command value for the scanning electromagnet and a command value for kinetic energy of the charged particle beam from a desired irradiation position coordinate of the charged particle beam in an irradiation subject so that irradiation to the irradiation subject is implemented on the basis of the command values concerned, and the scanning electromagnet and the kinetic energy of the charged particle beam are controlled on the basis of the command values generated from the desired irradiation position coordinate of the charged particle beam in the irradiation subject by using the inverse mapping model, thereby irradiating the irradiation subject with the charged particle beam while scanning the charged particle beam. In the particle beam irradiation of the present invention, the inverse mapping model is a polynomial expression of an inverse mapping mathematical expression model, and unknown coefficients existing in the polynomial expression are determined by inputting plural pairs of command values preset for the scanning electromagnet and also inputting plural preset command values of the kinetic energy to the scanning electromagnet to control the charged particle beam, and applying a least square method or a weighted least square method to actual data of actually irradiated irradiation position coordinates. Effect of the Invention The particle beam irradiation apparatus according to the present invention is provided with inverse mapping means having an inverse mapping model for generating a command value for the scanning electromagnet and a command value for kinetic energy of the charged particle beam from a desired irradiation position coordinate of the charged particle beam in an irradiation subject so that irradiation to the irradiation subject is implemented on the basis of the command values concerned. Therefore, there can be obtained the particle beam irradiation apparatus which can implement high-precision beam irradiation position. Furthermore, according to the particle beam irradiation apparatus of the present invention, the inverse mapping model is a polynomial expression of an inverse mapping mathematical expression model, and unknown coefficients existing in the polynomial expression are determined by inputting plural pairs of command values preset for the scanning electromagnet and also inputting plural preset command values of the kinetic energy to the scanning electromagnet to control the charged particle beam, and applying a least square method or a weighted least square method to actual data of actually irradiated irradiation position coordinates. Therefore, the unknown coefficients are based on the actual data, and thus there can be obtained the particle beam irradiation apparatus which can perform high-precision beam irradiation position. Accordingly, there can be implemented the high-precision beam irradiation position considering the variation of the irradiation position coordinate which is dependent on the fan beam effect and the cone beam effect. Brief Description of Drawings Fig. 1 is a diagram showing the construction of a particle beam irradiation apparatus according to a basic technique of the present invention. Fig. 2 is a diagram showing a method of calculating coefficients (unknown parameters) from actual data at the calibration time in the present invention. Fig. 3 is a block diagram showing the method of calculating the coefficients (unknown parameters) in the present invention. Fig. 4 is a flowchart showing the method of calculating the coefficients (unknown parameters) in this invention. Fig. 5 is a block diagram for determining an command value for a scanning electromagnet and an command value for kinetic energy of a charged particle beam from a treatment plan value in the present invention. Fig. 6 is a diagram showing the construction of a particle beam irradiation apparatus according to a first embodiment of the present invention. Fig. 7 is a diagram showing the construction of a particle beam irradiation apparatus according to a second embodiment of the present invention. Figs. 8A and 8B are diagrams showing a fan beam effect and a cone beam effect. Best Modes for Carrying the Invention Basic Technique of Invention Fig. 1 is a diagram showing the configuration of a particle beam irradiation apparatus for performing scanning irradiation according to a basic technique of the present invention. The particle beam irradiation apparatus has an accelerator 11 for accelerating a charged particle beam 1 to obtain a charged particle beam 1 having desired kinetic energy, a beam transport duct 2 for transporting the charged particle beam 1, a scanning electromagnet (scanning electromagnet) 3 for scanning the charged particle beam 1, a beam outlet window 4 for picking up a beam, a scanning controller 10 for transmitting an command value to the scanning electromagnet 3, etc. A beam transport system having the beam transport duct 2 is provided with a bending electromagnet, a beam monitor, a shielding electromagnet, a beam damper, an irradiation path bending electromagnet, etc. In the particle beam irradiation apparatus according to the basic technique of the invention, the scanning controller 10 has an inverse mapping mathematical expression model for a mapping from a beam irradiation position coordinate space 7 to a scanning electromagnet command value space 6. In other words, the scanning controller 10 has inverse mapping means 9 for generating, for a desired beam irradiation position coordinate, an estimation value of an command value for the scanning electromagnet 3 to implement the desired beam irradiation position coordinate concerned. Next, the operation of the particle beam irradiation apparatus will be described. The charged particle beam 1 which has been accelerated to have a desired kinetic energy by the accelerator 11 is passed through the beam transport duct 2 and led to an irradiation unit. The charged particle beam 1 is further picked up through the beam outlet window 4, and irradiated to an isocenter 5 as an irradiation reference point. In general, in order to selectively scan and irradiate a diseased site as an irradiation subject, the X and Y directions of the beam irradiation position of the charged particle beam 1 are generally controlled by an X-direction scanning electromagnet (X-direction scanning electromagnet) 3a and a Y-direction scanning electromagnet (Y-direction scanning electromagnet) 3b provided to the outside of the beam transport duct 2, and also the kinetic energy of the charged particle beam 1 is varied by the accelerator 11, whereby the Z-direction of the beam irradiation position (the depth direction of the diseased site)is controlled. The beam irradiation position is controlled according to a method of executing central control with an irradiation control device 23 (see Fig. 5) for controlling the overall particle beam irradiation apparatus or a method of executing distributed control with the scanning controller 10 for controlling the scanning electromagnet and the kinetic energy of the charged particle beam 1 of the accelerator. In the basic technique, the scanning controller 10 for controlling the irradiation position of the charged particle beam 1 is provided with the inverse mapping means 9 having the inverse mapping mathematical expression model for the mapping from the beam irradiation position coordinate space 7 to the scanning electromagnet command value space 6. A preferable example of the inverse mapping mathematical expression model is a polynomial expression model including desired irradiation position coordinates. A polynomial expression for the maximum order = 2 is represented by the following Mathematical Expression 1. In the basic technique, the Z-direction (depth direction) of the beam irradiation position is assumed to be uniquely determined by the kinetic energy of the charged particle beam, and plural inverse mapping mathematical expression models are created for different kinetic energies.MathematicalExpression 1{Iae=a00+a01⁢x+a02⁢x2+a10⁢y+a11⁢xy+a20⁢y2Ibe=b00+b01⁢x+b02⁢x2+b10⁢y+b11⁢xy+b20⁢y2 Here, a00, a01, a02,...,b00, b01, b02, ... represent coefficients (unknown parameters) for determining the characteristic of the inverse mapping mathematical expression model. Iae and Ibe represent estimation values of the respective command values for the X, Y-direction scanning electromagnets when the irradiation position coordinate of the charged particle beam is represented by (x,y). The coefficients (unknown parameters) for determining the characteristic of the inverse mapping mathematical expression model may be determined by performing test irradiation for calibration in advance and applying a least square method or the like on the actual data of the test irradiation. Fig. 2 is a diagram showing a method of calculating the coefficients (unknown parameters) from the actual data obtained under the calibration. In Fig. 1, 8 represents the direction of a forward mapping (actual physical phenomenon). Fig. 3 is a block diagram showing the method of calculating the coefficients (unknown parameters). Fig. 4 is a flowchart showing the method of calculating the coefficients (unknown parameters). In each figure, the same reference numerals represent same or corresponding parts. In the figures, 12 represent a first beam profile monitor, and it is disposed vertically to a reference irradiation axis 15 of the charged particle beam, and outputs the two-dimensional passage position coordinate (xa, ya) of the charged particle beam to be irradiated. Reference Sign 13 represents a second beam profile monitor, and it is disposed vertically to the reference irradiation axis 15 of the charged particle beam so as to be spaced from the first beam profile monitor 12 at a predetermined interval, and outputs the two-dimensional passage position coordinate (xb, yb) of the charged particle beam to be irradiated. 14 represents a water phantom, and it is disposed vertically to the reference irradiation axis 15 so that the surface thereof is fit to the body surface 16 of a patient, and outputs the coordinate zp in the depth direction of the position coordinate which the charged particle beam to be irradiated reaches. The first and second beam profile monitors 12 and 13 and the water phantom 14 are arranged when the unknown parameters are calculated or the charged particle beam is corrected or checked, and moved when the patient is irradiated with the charged particle beam. The test irradiation for calibration is executed while the following values are fluctuated by the scanning controller 10. Command value Ia for the X-direction scanning electromagnet (= current value, current value calculated and corrected in consideration of hysteresis, set magnetic field intensity, etc.) Command value Ib for the Y-direction scanning electromagnet (= current value, current value calculated and corrected in consideration of hysteresis, set magnetic field intensity, etc.) Kinetic energy command value E b for accelerator The charged particle beam 1 which is irradiated upon reception of the command values passes through the first and second beam profile monitors 12 and 13, and the measured passage position coordinates (xa, ya), (xb, yb) are output from the first and second beam profile monitors 12 and 13. It is also assumed that the depth-direction coordinate z which the irradiated charged particle beam 1 reaches is uniquely determined on the basis of the kinetic energy of the charged particle. Data processing means 17 (Fig. 3) calculates the irradiation position coordinate (x,y,z) from these values (xa, ya), (xb, yb) and z. As described above, the test irradiation for calibration is executed by fluctuating the respective command values. For example, the command value Ia for the X-direction scanning electromagnet is fluctuated to Ia+ΔIa, ...., and the command value Ib for the Y-direction scanning electromagnet is fluctuated to Ib+ΔIb,... Here, an example of a method of determining the coefficients (unknown parameters) of an inverse mapping from the actual data of the test irradiation will be described. The polynomial expression model shown in the Mathematical Expression 1 can be represented by using a matrix and vectors.MathematicalExpression 21xx2yxyy2︷Ac⁢a00b00a01b01a02b02a10b10a11b11a20b20︷Xc=IaeIbe︷Be Here, the matrix Ac is an input matrix of the inverse mapping including the irradiation position coordinates, a matrix Xc represents an unknown parameter matrix of the inverse mapping, and a matrix Be represents an output matrix of the inverse mapping including estimation values of the command values. The values of the unknown parameter matrix Xc have not yet been determined at this stage. The command values Bcarib for the test irradiation for calibration and the actual data of the irradiation positions Acarib are arranged according to the form of the Mathematical Expression 2 so as to form a vertically long matrix.MathematicalExpression 31x0x02y0x0⁢y0y021x1x12y1x1⁢y1y12⋮⋮⋮⋮⋮⋮1xnxn2ynxn⁢ynyn2︷Acarib⁢a00b00a01b01a02b02a10b10a11b11a20b20︷Xc=Ia⁢0Ib⁢0Ia⁢1Ib⁢1⋮⋮IanIbn︷Bcarib Here, the subscript numeral means the test irradiation number for calibration (in the above example, it means that test irradiation for n places is executed). The unknown parameter matrix Xc of the inverse mapping is determined according to the following expression based on the least square method.Mathematical Expression 4Xc=AcaribT⁢Acarib-1⁢AcaribT⁢Bcarib Here, the superscript T represents a transposed matrix. After the respective coefficients of the polynomial expression are determined through the above calibration, the actual irradiation is executed. First, it is checked by the beam monitor (not shown) provided to the beam transport duct 1 whether the beam incident point to the scanning electromagnet 3a does not vary from that under the calibration. At this time, when it is found that the beam incident point varies, the calibration procedure may be executed again to determine the respective coefficients. The order of the polynomial expression model of the Mathematical Expression 1, etc. may be properly increased in accordance with the characteristic of the particle beam irradiation apparatus being handled when it has strong non-linearity, and the order is not limited to the order = 2 indicated in the Mathematical Expression 1. Some polynomial expression models (inverse mapping mathematical expression models) may be prepared in advance so that an operator can select any polynomial expression model. Furthermore, the method disclosed in the patent document 3 or the like calculates the correction amount, however, it is different from the present invention that the inverse map mathematical expression of this invention determines an command itself. The particle beam irradiation apparatus is required to irradiate a charged particle beam three-dimensionally, and the desired beam irradiation position coordinate (x,y,z) is generally transmitted to the scanning controller 10 in the form of (x0, y0, z0) (x1, y1, z1) (x2, y2, z2), ... as shown in Fig. 6. Fig. 5 is a block diagram to determine the command values for the scanning electromagnets and the command value for the kinetic energy of the charged particle beam on the basis of treatment plan values. The desired beam irradiation position coordinates (x0, y0, z0) (x1, y1, z1) (x2, y2, z2), ... are transmitted through a data server 22 and the irradiation control device 23 to the scanning controller 10 by a treatment plan device 21 for a patient. The inverse mapping mathematical expression model and the kinetic energy command value Ebe in Fig. 5 will be described with reference to a first embodiment. As described above, the basic technique does not contain the control in the Z direction of the beam irradiation position with the kinetic energy of the charged particle beam of the accelerator set as a set value. Accordingly, when the beam incident point to the scanning electromagnet 3a is set not to vary, the desired beam irradiation position coordinates (x0, y0) (x1, y1) (x2, y2), ... are substituted into the inverse mapping mathematical expression model (Mathematical Expression 1) of the scanning controller 10, and the estimation values (Iae, Ibe),... of the scanning electromagnet command values are calculated for the respective desired beam irradiation position coordinates. In the basic technique, the inverse mapping is determined for each of the plural different charged particle beam kinetic energies. Specifically, there are prepared not only the inverse mapping mathematical expression model for the mapping to a plane A0-A0 containing the isocenter 5 as the irradiation reference, but also inverse mapping mathematical expression models for mappings to planes A-1-A-1, A-2-A-2, ... which are fixed in front of the isocenter 5 by changing the kinetic energy of the charged particle beam every -ΔEb (it is unnecessary to fluctuate at even intervals) and inverse mapping mathematical expression models for mappings to A1-A1, A2-A2, ... which are fixed at the backside of the isocenter 5 by changing the kinetic energy of the charged particle beam every +ΔEb. When the beam irradiation position coordinate in the irradiation subject is located between planes, linear interpolation is executed. As described above, the basic technique is provided with the calculating means (inverse mapping means) for calculating estimation values (Iae, Ibe) of the command values for the scanning electromagnets with respect to the desired irradiation position coordinate (x,y) on the irradiation reference plane so that the irradiation at the desired irradiation position coordinate (x,y) on the irradiation reference plane is implemented. Specifically, the inverse mapping means has a polynomial expression model of 2-input and 2-output. Therefore, there can be obtained the high-precision and high-reliability particle beam irradiation apparatus which compensates the beam position precision in accordance with the individual difference of the particle beam irradiation apparatus as a target, use environment and secular variation. First Embodiment Fig. 6 is a diagram showing the construction of a particle beam irradiation apparatus according to a first embodiment. In the basic technique of the present invention, the inverse mapping mathematical expression model is treated as a 2-input 2-output model. However, in the first embodiment, the inverse mapping mathematical expression model is treated as a 3-input 3-output comprising desired irradiation position coordinates as shown in Fig. 6 and the following Mathematical Expression 5 (described later). The following Mathematical Expression 5 represents a polynomial expression model in the case of 3-input, 3-output and the maximum order = 2.Mathematical Expression 5{Iae=a000+a001⁢x+a002⁢x2+a010⁢y+a011⁢xy+a020⁢y2+a100⁢z+a101⁢xz+a110⁢yz+a200⁢z2Ibe=b000+b001⁢x+b002⁢x2+b010⁢y+b011⁢xy+b020⁢y2+b100⁢z+b101⁢xz+b110⁢yz+b200⁢z2Ebe=c000+c001⁢x+c002⁢x2+c010⁢y+c011⁢xy+c020⁢y2+c100⁢z+c101⁢xz+c110⁢yz+c200⁢z2 Here, a000, a001, a002, ...., b000 b001, b002, ..., c000, c001, c002, ..., represent coefficients (unknown parameters) for determining the characteristic of the inverse mapping mathematical expression model. Iae, Ibhe, Ebe represent estimation values of the X-direction and Y- direction command values for the X-direction and Y-direction scanning magnets and an estimation value of an command value of the kinetic energy of the charged particle beam for the accelerator when the irradiation position coordinate of the charged particle beam is represented by (x,y,z). As in the case of the basic technique of the present invention, the coefficients (unknown parameters) for determining the characteristic of the inverse mapping mathematical expression model are determined by executing test irradiation for calibration and applying the least square method or the like on the actual data of the test irradiation. The test irradiation for calibration is executed by fluctuating the following values with the scanning controller 10. Command value Ia for the X-direction scanning electromagnet (= current value, current value calculated and corrected in consideration of hysteresis, set magnetic field intensity, etc.) Command value Ib for the Y-direction scanning electromagnet (= current value, current value calculated and corrected in consideration of hysteresis, set magnetic field intensity, etc.) Kinetic energy command value E b for accelerator Upon reception of the command values, the irradiated charged particle beam 1 passes through the first and second beam profile monitors 12, 13, and measured passage position coordinates (xa, ya), (xb, yb) are output from the first and second beam profile monitors 12 and 13 as shown in Figs. 2, 3 and 4. Furthermore, the irradiated charged particle beam 1 arrives at the water phantom 14, and the coordinate zp in the depth direction of the position coordinate at which it arrives is output. The data processing means 17 (Fig. 3) which obtains these output values determines (xp, yp)of the arrival position coordinate from (xa, ya), (xb, yb) and Zp, and determines the arrival position coordinate (xp, yp, zp). As described above, the test irradiation for calibration is executed by fluctuating the value of each command value. For example, the command value Ia for the X-direction scanning electromagnet is fluctuated to Ia+ΔIa, ..., the command value Ib for the Y-direction scanning electromagnet is fluctuated to Ib+ΔIb,..., and the kinetic energy command value Eb for the accelerator is fluctuated to Eb+AEb,.... Here, an example of a method of determining the coefficients (unknown parameters) of the inverse mapping in the case of 3-input and 3-output from the actual data of the test irradiation will be described. The polynomial expression model shown in the Mathematical Expression 5 can be represented as follows by using a matrix and vectors.Mathematical Expression 61xx2yxyy2zxzyzz2︷Ac⁢a000b000c000a001c001c001a002b002c002a010b010c010a011b011c011a020b020c020a100b100c100a101b101b101a110b110c110a200b200c200︷Xc=IaeIbeEbe︷Be Here, the matrix Ac represents an input matrix of the inverse mapping comprising the irradiation position coordinates, the matrix Xc represents an unknown parameter matrix of the inverse mapping, and the matrix Be represents an output matrix of the inverse mapping comprising estimation values of command values. The values of the unknown parameter matrix Xc have not yet been determined at this stage. The command values obtained in the test irradiation for calibration and the actual data of the irradiation positions are arranged according to the form of the Mathematical Expression 6 so as to form a vertically long matrix. The command values Bcarib in the case of the test irradiation for calibration and the actual data of the obtained irradiation positions Acarib are arranged vertically according to the form of the Mathematical Expression 6 so as to form a vertically long matrix.MathematicalExpression71x0x02y0x0⁢y0y02z0x0⁢z0y0⁢z0z021x1x12y1x1⁢y1y12z1x1⁢z1y1⁢z1z12⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮1xnxn2ynxn⁢ynyn2znxn⁢znyn⁢znzn2︷Acarib⁢a000b000c000a001c001c001a002b002c002a010b010c010a011b011c011a020b020c020a100b100c100a101b101b101a110b110c110a200b200c200︷Xc=Ia⁢0Ib⁢0Eb⁢0Ia⁢1Ib⁢1Eb⁢1⋮⋮⋮IanIbnEbn︷Bcarib Here, the subscript numeral means the test irradiation number of calibration (in the above example, it means that the test irradiation for n places is executed). The unknown parameter matrix Xc of the inverse mapping is determined by the Mathematical Expression 4 based on the least square method as in the case of the basic technique. After the respective coefficients of the polynomial expression is determined by the above calibration, the actual irradiation is executed. First, it is checked by the beam monitor (not shown) provided to the beam transport duct 1 that the beam incident point to the scanning electromagnet 3a does not vary from that at the calibration time. At this time, when it is found that the beam incident point varies, the calibration procedure may be executed again to determine the respective coefficients. The least square method has been described as the method of determining the coefficients (unknown parameters) of the polynomial expression. According to the present invention, when the coefficients (unknown parameters) of the polynomial expression are determined, a weighted least square method is used. According to the weighted least square method, the calculation is performed while respective original data (actual data at the calibration time) for determining the coefficients (unknown parameters) of the polynomial expression are weighted. For example, there is a case where low-reliability data are obtained due to some factor (for example, electrical noise or the like) in the test irradiation for calibration. In this case, the low-reliability data are multiplied by a weight which is near to zero, whereby the influence of these data can be suppressed. Furthermore, the irradiation subject is divided into some areas, and the unknown parameters of the polynomial expression are determined every area. In this case, when the polynomial expression of some area A is calculated, the calculation is performed while data belonging to the area A are multiplied by a weight "1" and data which do not belong to the area A is multiplied by a weight near to zero, whereby irradiation nearer to an actual phenomenon, that is, high-precision irradiation can be implemented. The order of the polynomial expression model as the inverse mapping mathematical expression model may be properly increased in accordance with the characteristic of the particle beam irradiation apparatus being handled when it has strong non-linearity, and the order is not limited to the order = 2 indicated in the Mathematical Expression 5. In the first embodiment, some polynomial expression models may be also prepared in advance so that an operator can select any polynomial expression model. In the first embodiment, the desired beam irradiation position coordinates (x0, y0, z0) (x1, y1, z1) (x2, y2, z2) ... are also transmitted through the data server 22 and the irradiation control device 23 to the scanning controller 10 by the treatment plan device 21 for a patient as shown in Fig. 5. When the beam incident point to the scanning electromagnet 3a is set not to vary, the transmitted desired beam irradiation position coordinates (x0, y0, z0) (x1, y1, z1) (x2, y2, z2) ... are substituted into the inverse mapping mathematical expression model (Mathematical Expression 5) of the scanning controller 10, and the estimation values (Iae, Ibe)... of the command values for the scanning electromagnets and the estimation values (Ebe) ... of the kinetic energy command values are calculated for the respective desired beam irradiation position coordinates. The position control of the charged particle beam is roughly performed by the scanning electromagnet 3 for the X and Y directions and by the adjustment of the kinetic energy of the charged particle beam for the Z direction. However, strictly, the control cannot be so clearly divided into XY and Z. When the charged particle beam is controlled by the scanning electromagnet 3, it affects not only the XY directions, but also the Z direction. Likewise, when the kinetic energy of the charged particle beam is controlled, not only the Z direction, but also the XY directions may be affected. Such an effect as described above is referred to as "interference term effect between XY and Z. The inverse mapping mathematical expression model of 3-input and 3-output can generate the command values in consideration of the interference term effect between XY and Z. In the conventional methods based on deflection correction (for example, patent document 3), no attention is paid to the Z direction. However, according to the first embodiment, the Z-direction is also considered by preparing plural inverse mapping mathematical expression models as described above. As described above, the inverse mapping mathematical model in the scanning controller 10 is set to the 3-input and 3-output comprising the desired irradiation position coordinates. Therefore, the command values for the scanning electromagnet 3 and the kinetic energy command value for the charged particle beam 1 can be determined at a time, and the command values can be generated in consideration of the interference term effect between XY and Z, so that the beam position control can be implemented with higher precision. Furthermore, there can be implemented a high-precision beam irradiation position which is dependent on the fan beam effect and the cone beam effect and considers the variation of the irradiation position coordinate. As a background example, a conversion table may be prepared as an inverse mapping model for generating an command value for the scanning electromagnet and an command value for the kinetic energy of the charged particle beam from a desired irradiation position coordinate of the charged particle beam in the irradiation subject so that the irradiation to the desired irradiation position coordinate is implemented, and the scanning electromagnet and the kinetic energy of the charged particle beam may be controlled on the basis of the command values generated from the desired irradiation position coordinate of the charged particle beam in the irradiation subject by using the conversion table, thereby irradiating the irradiation subject with the charged particle beam while scanning the charged particle beam. Second Embodiment Fig. 7 is a diagram showing the construction of a particle beam irradiation apparatus according to a second embodiment. 31 represents a final bending electromagnet provided to the beam transport system, and it is disposed upstream of the Y-direction scanning electromagnet 3b and deflects the charged particle beam to A, B and C passages. Fig. 1 of the basic technique of the invention shows a simple case where the scanning electromagnet 3 is disposed at the most downstream side. However, there is a case where the bending electromagnet is disposed at the downstream side of the scanning electromagnet (scanning electromagnet, wobbler electromagnet) as in the case of the particle beam irradiation apparatus of the Patent Document 1, or a case where the scanning electromagnet is omitted by making good use of the bending electromagnet as in the case of the particle beam irradiation apparatus of the patent document 2. This invention can be applied to the above constructions. In these cases, the forward mapping from the command value coordinate space 6 to the beam irradiation position coordinate space 7 is more complicated, and thus the effect of this invention is greater. In Fig. 7, the Y-direction scanning electromagnet 3b is used, and the final bending electromagnet 31 is brought with the function of the X-direction scanning electromagnet. The command value Ia for the X-direction scanning electromagnet is generated from the final bending electromagnet 31, the charged particle beam is scanned, and the estimation value Iae of the command value for the X-direction scanning electromagnet is input to the final bending electromagnet 31. As described above, the final bending electromagnet 31 is brought with the same function as the X-direction scanning electromagnet. A particle beam irradiation apparatus suitable for cancer treatment, comprising: - an accelerator (11);- a scanning electromagnet (3); and- a controller (10) for controlling the accelerator (11) and the scanning electromagnet (3) to irradiate a charged particle beam (1) from the accelerator (11) to an irradiation subject,- the scanning electromagnet (3) having: an X-direction scanning electromagnet (3a); and a Y-direction scanning electromagnet (3b) for scanning in a direction perpendicular to a scanning direction of the X-direction scanning electromagnet (3a),- the controller (10) having: an X-direction inverse mapping mathematical expression model for generating an X-direction command value for exciting the X-direction scanning electromagnet (3a); and a Y-direction inverse mapping mathematical expression model for generating a Y-direction command value for exciting the Y-direction scanning electromagnet (3b), said command values are generated from a desired irradiation position coordinate of the charged particle beam (1) in the irradiation subject, so that irradiation to the irradiation subject is implemented on the basis of the command values concerned,characterized in that the X-direction and Y-direction inverse mapping mathematical expression models are polynomial expressions containing variables x, y and z representing the desired irradiation position coordinate according to {Iae=a000+a001⁢x+a002⁢x2+a010⁢y+a011⁢xy+a020⁢y2+a100⁢z+a101⁢xz+a110⁢yz+a200⁢z2Ibe=b000+b001⁢x+b002⁢x2+b010⁢y+b011⁢xy+b020⁢y2+b100⁢z+b101⁢xz+b110⁢yz+b200⁢z2Ebe=c000+c001⁢x+c002⁢x2+c010⁢y+c011⁢xy+c020⁢y2+c100⁢z+c101⁢xz+c110⁢yz+c200⁢z2- wherein here, a000, a001, a002, ....., b000 b001, b002, ..., c000, c001, c002, ..., represent unknown coefficients, Iae, Ibe, Ebe represent the X-direction and Y-direction command values for the X-direction and Y-direction scanning electromagnets and a command value of the kinetic energy of the charged particle beam for the accelerator when the irradiation position coordinate of the charged particle beam is represented by x, y, and z,- wherein the unknown coefficients contained in the polynomial expressions are determined by the input of a plurality of pairs of preset X-direction and Y-direction command values to the X-direction and Y-direction scanning electromagnets (3a, 3b) and also by the input of a plurality of preset kinetic energy command values to the accelerator (11) to control the charged particle beam for test irradiation and by performing a weighted least-square method of executing near to zero weighting on low-reliability data on the actual data of the test irradiation position coordinates at which the charged particle beam (1) is actually irradiated, the low-reliability data are multiplied by a weight which is near to zero, whereby the influence of these data can be suppressed, wherein in order to determine the unknown coefficients contained in the polynomial expressions, the irradiation subject is divided into a plurality of areas, and the unknown coefficients contained in the polynomial expressions are determined in every area such as when the polynomial expression of some area A is calculated, the calculation is performed while data belonging to the area A are multiplied by a weight "1" and data which do not belong to the area A is multiplied by a weight near to zero. The apparatus according to claim 1, wherein the controller (10) further has: a kinetic energy inverse mapping mathematical expression model for generating the command value of kinetic energy for the accelerator (11) for accelerating the charged particle beam (1).